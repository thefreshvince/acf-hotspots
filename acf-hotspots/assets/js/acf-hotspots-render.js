"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),HotspotInput=function(t){var e="acf-hotspot",i=function(){function t(i){_classCallCheck(this,t),this.class_point=e+"__point",this.x=i.x,this.y=i.y,this.context=i.context,this.i=this.context.points.length,this.point=this.create_point(i.x,i.y),i.exists||(this.inputs=this.create_inputs(i.x,i.y))}return _createClass(t,[{key:"create_inputs",value:function(t,i){for(var s=this.context.spot_clone.cloneNode(!0),n=s.getElementsByClassName("acf-hotspot__input"),a=this.i,o=s.getElementsByClassName("acf-hotspot__label")[0],r=0,c=n.length;r<c;r++){var l=n[r].getAttribute("data-name").replace("!!N!!",a);n[r].setAttribute("name",l)}return o.innerHTML=o.innerHTML.replace(/!!N!!/g,a+1),s.getElementsByClassName(e+"__input--x")[0].value=t,s.getElementsByClassName(e+"__input--y")[0].value=i,this.context.spot_clone_original.parentNode.appendChild(s),s}},{key:"create_point",value:function(t,e){var i=document.createElement("div"),s=document.createTextNode(this.i+1);return i.classList.add(this.class_point),i.style.left=100*t+"%",i.style.top=100*e+"%",i.appendChild(s),this.context.main_image.parentNode.insertBefore(i,this.context.main_image),i}}]),t}();return function(){function s(i){_classCallCheck(this,s),this.el=i,this.source_image=t("."+e+"__upload .acf-image-uploader .view img",i),this.img_src="",this.main_image=this.el[0].getElementsByClassName(e+"__image")[0],this.points=[],this.spot_clone=this.generate_spot_clone(),this.init()}return _createClass(s,[{key:"add_exisiting_points",value:function(){for(var t=document.getElementsByClassName(e+"__point-fields"),s=0,n=t.length;s<n;s++){var a=t[s].getElementsByClassName(e+"__input--x")[0].value,o=t[s].getElementsByClassName(e+"__input--y")[0].value;this.points.push(new i({x:a,y:o,context:this,exists:!0}))}}},{key:"generate_spot_clone",value:function(){var t=this.el[0].getElementsByClassName(e+"__clone-base")[0],i=t.cloneNode(!0);return this.spot_clone_original=t,i.classList.remove(e+"__clone-base"),i.classList.add(e+"__point-fields"),i}},{key:"change_hotspot_image",value:function(){this.img_src=this.source_image[0].getAttribute("src"),this.img_src=this.img_src.replace(/-\d+x\d+\./g,"."),this.main_image.setAttribute("src",this.img_src)}},{key:"watch_for_new_image",value:function(){var t=this;this.source_image.on("load error",function(){return t.change_hotspot_image()})}},{key:"listen_for_user_clicks",value:function(){var t=this;this.main_image.addEventListener("click",function(e){return t.create_hotspot_point(e.offsetX,e.offsetY)})}},{key:"create_hotspot_point",value:function(t,e){if(confirm("Are you sure you would like to create a new point?")){var s=this.main_image.offsetWidth,n=this.main_image.offsetHeight,a=new i({x:t/s,y:e/n,context:this});return this.points.push(a)}}},{key:"init",value:function(){this.watch_for_new_image(),this.change_hotspot_image(),this.listen_for_user_clicks(),this.add_exisiting_points()}}]),s}()}(jQuery);
"use strict";!function(t){"undefined"!=typeof acf.add_action?acf.add_action("ready append",function(n){acf.get_fields({type:"hotspots"},n).each(function(){new HotspotInput(t(this))})}):t(document).on("acf/setup_fields",function(n,e){t(e).find('.field[data-field_type="hotspots"]').each(function(){new HotspotInput(t(this))})})}(jQuery);
//# sourceMappingURL=acf-hotspots-render.js.map
